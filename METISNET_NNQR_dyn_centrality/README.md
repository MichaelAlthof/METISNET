[<img src="https://github.com/QuantLet/Styleguide-and-FAQ/blob/master/pictures/banner.png" width="888" alt="Visit QuantNet">](http://quantlet.de/)

## [<img src="https://github.com/QuantLet/Styleguide-and-FAQ/blob/master/pictures/qloqo.png" alt="Visit QuantNet">](http://quantlet.de/) **METISNET_NNQR_dyn_centrality** [<img src="https://github.com/QuantLet/Styleguide-and-FAQ/blob/master/pictures/QN2.png" width="60" alt="Visit QuantNet 2.0">](http://quantlet.de/)

```yaml

Name of QuantLet : METISNET_NNQR_dyn_centrality

Published in : METIS

Description : 'Plots the dynamic centrality of risk spillover network of large banks, via thresholding by only considering the 30% largest connections of the network. Window size is 252 trading days and step is 22 trading days'

Keywords : quantile regression, neural networks, systemic risk, centrality in time, spillover effect

See also : 'NNQR_CoVaR, NNQR_Heat, NNQR_SNRI, MNQR_Network, METISNET_NNQR_centrality'

Authors : Ya Qian

Submitted : April 10 2019 by Ya Qian

```

![Picture1](banking_network_in_degree_centrality_1.png)

![Picture2](banking_network_in_degree_centrality_10.png)

![Picture3](banking_network_in_degree_centrality_100.png)

![Picture4](banking_network_in_degree_centrality_101.png)

![Picture5](banking_network_in_degree_centrality_102.png)

![Picture6](banking_network_in_degree_centrality_103.png)

![Picture7](banking_network_in_degree_centrality_104.png)

![Picture8](banking_network_in_degree_centrality_105.png)

![Picture9](banking_network_in_degree_centrality_106.png)

![Picture10](banking_network_in_degree_centrality_107.png)

![Picture11](banking_network_in_degree_centrality_108.png)

![Picture12](banking_network_in_degree_centrality_11.png)

![Picture13](banking_network_in_degree_centrality_12.png)

![Picture14](banking_network_in_degree_centrality_13.png)

![Picture15](banking_network_in_degree_centrality_14.png)

![Picture16](banking_network_in_degree_centrality_15.png)

![Picture17](banking_network_in_degree_centrality_16.png)

![Picture18](banking_network_in_degree_centrality_17.png)

![Picture19](banking_network_in_degree_centrality_18.png)

![Picture20](banking_network_in_degree_centrality_19.png)

![Picture21](banking_network_in_degree_centrality_2.png)

![Picture22](banking_network_in_degree_centrality_20.png)

![Picture23](banking_network_in_degree_centrality_21.png)

![Picture24](banking_network_in_degree_centrality_22.png)

![Picture25](banking_network_in_degree_centrality_23.png)

![Picture26](banking_network_in_degree_centrality_24.png)

![Picture27](banking_network_in_degree_centrality_25.png)

![Picture28](banking_network_in_degree_centrality_26.png)

![Picture29](banking_network_in_degree_centrality_27.png)

![Picture30](banking_network_in_degree_centrality_28.png)

![Picture31](banking_network_in_degree_centrality_29.png)

![Picture32](banking_network_in_degree_centrality_3.png)

![Picture33](banking_network_in_degree_centrality_30.png)

![Picture34](banking_network_in_degree_centrality_31.png)

![Picture35](banking_network_in_degree_centrality_32.png)

![Picture36](banking_network_in_degree_centrality_33.png)

![Picture37](banking_network_in_degree_centrality_34.png)

![Picture38](banking_network_in_degree_centrality_35.png)

![Picture39](banking_network_in_degree_centrality_36.png)

![Picture40](banking_network_in_degree_centrality_37.png)

![Picture41](banking_network_in_degree_centrality_38.png)

![Picture42](banking_network_in_degree_centrality_39.png)

![Picture43](banking_network_in_degree_centrality_4.png)

![Picture44](banking_network_in_degree_centrality_40.png)

![Picture45](banking_network_in_degree_centrality_41.png)

![Picture46](banking_network_in_degree_centrality_42.png)

![Picture47](banking_network_in_degree_centrality_43.png)

![Picture48](banking_network_in_degree_centrality_44.png)

![Picture49](banking_network_in_degree_centrality_45.png)

![Picture50](banking_network_in_degree_centrality_46.png)

![Picture51](banking_network_in_degree_centrality_47.png)

![Picture52](banking_network_in_degree_centrality_48.png)

![Picture53](banking_network_in_degree_centrality_49.png)

![Picture54](banking_network_in_degree_centrality_5.png)

![Picture55](banking_network_in_degree_centrality_50.png)

![Picture56](banking_network_in_degree_centrality_51.png)

![Picture57](banking_network_in_degree_centrality_52.png)

![Picture58](banking_network_in_degree_centrality_53.png)

![Picture59](banking_network_in_degree_centrality_54.png)

![Picture60](banking_network_in_degree_centrality_55.png)

![Picture61](banking_network_in_degree_centrality_56.png)

![Picture62](banking_network_in_degree_centrality_57.png)

![Picture63](banking_network_in_degree_centrality_58.png)

![Picture64](banking_network_in_degree_centrality_59.png)

![Picture65](banking_network_in_degree_centrality_6.png)

![Picture66](banking_network_in_degree_centrality_60.png)

![Picture67](banking_network_in_degree_centrality_61.png)

![Picture68](banking_network_in_degree_centrality_62.png)

![Picture69](banking_network_in_degree_centrality_63.png)

![Picture70](banking_network_in_degree_centrality_64.png)

![Picture71](banking_network_in_degree_centrality_65.png)

![Picture72](banking_network_in_degree_centrality_66.png)

![Picture73](banking_network_in_degree_centrality_67.png)

![Picture74](banking_network_in_degree_centrality_68.png)

![Picture75](banking_network_in_degree_centrality_69.png)

![Picture76](banking_network_in_degree_centrality_7.png)

![Picture77](banking_network_in_degree_centrality_70.png)

![Picture78](banking_network_in_degree_centrality_71.png)

![Picture79](banking_network_in_degree_centrality_72.png)

![Picture80](banking_network_in_degree_centrality_73.png)

![Picture81](banking_network_in_degree_centrality_74.png)

![Picture82](banking_network_in_degree_centrality_75.png)

![Picture83](banking_network_in_degree_centrality_76.png)

![Picture84](banking_network_in_degree_centrality_77.png)

![Picture85](banking_network_in_degree_centrality_78.png)

![Picture86](banking_network_in_degree_centrality_79.png)

![Picture87](banking_network_in_degree_centrality_8.png)

![Picture88](banking_network_in_degree_centrality_80.png)

![Picture89](banking_network_in_degree_centrality_81.png)

![Picture90](banking_network_in_degree_centrality_82.png)

![Picture91](banking_network_in_degree_centrality_83.png)

![Picture92](banking_network_in_degree_centrality_84.png)

![Picture93](banking_network_in_degree_centrality_85.png)

![Picture94](banking_network_in_degree_centrality_86.png)

![Picture95](banking_network_in_degree_centrality_87.png)

![Picture96](banking_network_in_degree_centrality_88.png)

![Picture97](banking_network_in_degree_centrality_89.png)

![Picture98](banking_network_in_degree_centrality_9.png)

![Picture99](banking_network_in_degree_centrality_90.png)

![Picture100](banking_network_in_degree_centrality_91.png)

![Picture101](banking_network_in_degree_centrality_92.png)

![Picture102](banking_network_in_degree_centrality_93.png)

![Picture103](banking_network_in_degree_centrality_94.png)

![Picture104](banking_network_in_degree_centrality_95.png)

![Picture105](banking_network_in_degree_centrality_96.png)

![Picture106](banking_network_in_degree_centrality_97.png)

![Picture107](banking_network_in_degree_centrality_98.png)

![Picture108](banking_network_in_degree_centrality_99.png)

![Picture109](banking_network_out_degree_centrality_1.png)

![Picture110](banking_network_out_degree_centrality_10.png)

![Picture111](banking_network_out_degree_centrality_100.png)

![Picture112](banking_network_out_degree_centrality_101.png)

![Picture113](banking_network_out_degree_centrality_102.png)

![Picture114](banking_network_out_degree_centrality_103.png)

![Picture115](banking_network_out_degree_centrality_104.png)

![Picture116](banking_network_out_degree_centrality_105.png)

![Picture117](banking_network_out_degree_centrality_106.png)

![Picture118](banking_network_out_degree_centrality_107.png)

![Picture119](banking_network_out_degree_centrality_108.png)

![Picture120](banking_network_out_degree_centrality_11.png)

![Picture121](banking_network_out_degree_centrality_12.png)

![Picture122](banking_network_out_degree_centrality_13.png)

![Picture123](banking_network_out_degree_centrality_14.png)

![Picture124](banking_network_out_degree_centrality_15.png)

![Picture125](banking_network_out_degree_centrality_16.png)

![Picture126](banking_network_out_degree_centrality_17.png)

![Picture127](banking_network_out_degree_centrality_18.png)

![Picture128](banking_network_out_degree_centrality_19.png)

![Picture129](banking_network_out_degree_centrality_2.png)

![Picture130](banking_network_out_degree_centrality_20.png)

![Picture131](banking_network_out_degree_centrality_21.png)

![Picture132](banking_network_out_degree_centrality_22.png)

![Picture133](banking_network_out_degree_centrality_23.png)

![Picture134](banking_network_out_degree_centrality_24.png)

![Picture135](banking_network_out_degree_centrality_25.png)

![Picture136](banking_network_out_degree_centrality_26.png)

![Picture137](banking_network_out_degree_centrality_27.png)

![Picture138](banking_network_out_degree_centrality_28.png)

![Picture139](banking_network_out_degree_centrality_29.png)

![Picture140](banking_network_out_degree_centrality_3.png)

![Picture141](banking_network_out_degree_centrality_30.png)

![Picture142](banking_network_out_degree_centrality_31.png)

![Picture143](banking_network_out_degree_centrality_32.png)

![Picture144](banking_network_out_degree_centrality_33.png)

![Picture145](banking_network_out_degree_centrality_34.png)

![Picture146](banking_network_out_degree_centrality_35.png)

![Picture147](banking_network_out_degree_centrality_36.png)

![Picture148](banking_network_out_degree_centrality_37.png)

![Picture149](banking_network_out_degree_centrality_38.png)

![Picture150](banking_network_out_degree_centrality_39.png)

![Picture151](banking_network_out_degree_centrality_4.png)

![Picture152](banking_network_out_degree_centrality_40.png)

![Picture153](banking_network_out_degree_centrality_41.png)

![Picture154](banking_network_out_degree_centrality_42.png)

![Picture155](banking_network_out_degree_centrality_43.png)

![Picture156](banking_network_out_degree_centrality_44.png)

![Picture157](banking_network_out_degree_centrality_45.png)

![Picture158](banking_network_out_degree_centrality_46.png)

![Picture159](banking_network_out_degree_centrality_47.png)

![Picture160](banking_network_out_degree_centrality_48.png)

![Picture161](banking_network_out_degree_centrality_49.png)

![Picture162](banking_network_out_degree_centrality_5.png)

![Picture163](banking_network_out_degree_centrality_50.png)

![Picture164](banking_network_out_degree_centrality_51.png)

![Picture165](banking_network_out_degree_centrality_52.png)

![Picture166](banking_network_out_degree_centrality_53.png)

![Picture167](banking_network_out_degree_centrality_54.png)

![Picture168](banking_network_out_degree_centrality_55.png)

![Picture169](banking_network_out_degree_centrality_56.png)

![Picture170](banking_network_out_degree_centrality_57.png)

![Picture171](banking_network_out_degree_centrality_58.png)

![Picture172](banking_network_out_degree_centrality_59.png)

![Picture173](banking_network_out_degree_centrality_6.png)

![Picture174](banking_network_out_degree_centrality_60.png)

![Picture175](banking_network_out_degree_centrality_61.png)

![Picture176](banking_network_out_degree_centrality_62.png)

![Picture177](banking_network_out_degree_centrality_63.png)

![Picture178](banking_network_out_degree_centrality_64.png)

![Picture179](banking_network_out_degree_centrality_65.png)

![Picture180](banking_network_out_degree_centrality_66.png)

![Picture181](banking_network_out_degree_centrality_67.png)

![Picture182](banking_network_out_degree_centrality_68.png)

![Picture183](banking_network_out_degree_centrality_69.png)

![Picture184](banking_network_out_degree_centrality_7.png)

![Picture185](banking_network_out_degree_centrality_70.png)

![Picture186](banking_network_out_degree_centrality_71.png)

![Picture187](banking_network_out_degree_centrality_72.png)

![Picture188](banking_network_out_degree_centrality_73.png)

![Picture189](banking_network_out_degree_centrality_74.png)

![Picture190](banking_network_out_degree_centrality_75.png)

![Picture191](banking_network_out_degree_centrality_76.png)

![Picture192](banking_network_out_degree_centrality_77.png)

![Picture193](banking_network_out_degree_centrality_78.png)

![Picture194](banking_network_out_degree_centrality_79.png)

![Picture195](banking_network_out_degree_centrality_8.png)

![Picture196](banking_network_out_degree_centrality_80.png)

![Picture197](banking_network_out_degree_centrality_81.png)

![Picture198](banking_network_out_degree_centrality_82.png)

![Picture199](banking_network_out_degree_centrality_83.png)

![Picture200](banking_network_out_degree_centrality_84.png)

![Picture201](banking_network_out_degree_centrality_85.png)

![Picture202](banking_network_out_degree_centrality_86.png)

![Picture203](banking_network_out_degree_centrality_87.png)

![Picture204](banking_network_out_degree_centrality_88.png)

![Picture205](banking_network_out_degree_centrality_89.png)

![Picture206](banking_network_out_degree_centrality_9.png)

![Picture207](banking_network_out_degree_centrality_90.png)

![Picture208](banking_network_out_degree_centrality_91.png)

![Picture209](banking_network_out_degree_centrality_92.png)

![Picture210](banking_network_out_degree_centrality_93.png)

![Picture211](banking_network_out_degree_centrality_94.png)

![Picture212](banking_network_out_degree_centrality_95.png)

![Picture213](banking_network_out_degree_centrality_96.png)

![Picture214](banking_network_out_degree_centrality_97.png)

![Picture215](banking_network_out_degree_centrality_98.png)

![Picture216](banking_network_out_degree_centrality_99.png)

### R Code
```r

# clear all variables
rm(list = ls(all = TRUE))
graphics.off()
#setwd("")

# install and load packages
libraries = c("igraph")
lapply(libraries, function(x) if (!(x %in% installed.packages())) {
  install.packages(x)
})
lapply(libraries, library, quietly = TRUE, character.only = TRUE)


# get yearly average, moving window
#for (i in 1:ceiling((length(date2)-251)/22)){
for (i in 1:2){
     annual_ave_spill = rowMeans(b[,,(1+22*(i-1)):(252+22*(i-1))])
     network = graph_from_adjacency_matrix(annual_ave_spill, weighted = T, diag = F)
     E(network)$width = ((E(network)$weight)) * 5
     E(network)$color = "black"
     V(network)$name  = names
     V(network)$color = "yellow"
     V(network)$label.cex = 1
     threshold = delete.edges(network, which(E(network)$weight < quantile(E(network)$weight, 0.7)))
     dc1 = degree(threshold, mode = 'in')
     dc2 = degree(threshold, mode = 'out')
     png(paste('banking_network_in_degree_centrality_',i,'.png', sep = ''))
     plot.igraph(threshold, vertex.size = dc1*8, edge.arrow.size = 0.2, 
                 edge.curved = 0.2, layout = layout.circle(network))
     dev.off()
     png(paste('banking_network_out_degree_centrality_',i,'.png', sep = ''))
     plot.igraph(threshold, vertex.size = dc2*8, edge.arrow.size = 0.2, 
                 edge.curved = 0.2, layout = layout.circle(network))
     dev.off()
     }






par(mar = c(0, 0, 0, 0))
png('banking_network_without_centrality.png')
plot.igraph(threshold, vertex.size = 30, edge.arrow.size = 0.2, 
            edge.curved = 0.2, layout = layout.circle(network))
dev.off()

# centrality scores
# degree centrality
dc1 = degree(threshold, mode = 'in')
dc2 = degree(threshold, mode = 'out')
dc3 = degree(threshold, mode = 'total')
png('banking_network_in_degree_centrality.png')
plot.igraph(threshold, vertex.size = dc1*8, edge.arrow.size = 0.2, 
            edge.curved = 0.2, layout = layout.circle(network))

dev.off()

png('banking_network_out_degree_centrality.png')
plot.igraph(threshold, vertex.size = dc2*8, edge.arrow.size = 0.2, 
            edge.curved = 0.2, layout = layout.circle(network))

dev.off()

png('banking_network_total_degree_centrality.png')
plot.igraph(threshold, vertex.size = dc3*8, edge.arrow.size = 0.2, 
            edge.curved = 0.2, layout = layout.circle(network))

dev.off()

# closeness centrality
cc1 = closeness(threshold, mode = 'in', weights = E(threshold)$weight)
cc2 = closeness(threshold, mode = 'out', weights = E(threshold)$weight)
cc3 = closeness(threshold, mode = 'total', weights = E(threshold)$weight)
png('banking_network_in_closeness_centrality.png')
plot.igraph(threshold, vertex.size = cc1*100, edge.arrow.size = 0.2, 
            edge.curved = 0.2, layout = layout.circle(network))

dev.off()

png('banking_network_out_closeness_centrality.png')
plot.igraph(threshold, vertex.size = cc2*100, edge.arrow.size = 0.2, 
            edge.curved = 0.2, layout = layout.circle(network))

dev.off()

png('banking_network_total_closeness_centrality.png')
plot.igraph(threshold, vertex.size = cc3*100, edge.arrow.size = 0.2, 
            edge.curved = 0.2, layout = layout.circle(network))

dev.off()

# betweenness centrality
bc = betweenness(threshold, directed = TRUE, weights = E(threshold)$weight)

png('banking_network_betweenness_centrality.png')
plot.igraph(threshold, vertex.size = bc*3, edge.arrow.size = 0.2, 
            edge.curved = 0.2, layout = layout.circle(network))

dev.off()

# eigenvector centrality
ec = eigen_centrality(threshold, directed = TRUE, weights = E(threshold)$weight, scale = FALSE)
ec1=ec$vector
png('banking_network_eigenvector_centrality.png')
plot.igraph(threshold, vertex.size = ec1*50, edge.arrow.size = 0.2, 
            edge.curved = 0.2, layout = layout.circle(network))

dev.off()
```

automatically created on 2019-04-18